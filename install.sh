#!/bin/bash
# ==============================================================
#  –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –°–ö–†–ò–ü–¢ –£–°–¢–ê–ù–û–í–ö–ò FunPay Cortex –î–õ–Ø TERMUX
#  –í–µ—Ä—Å–∏—è –æ—Ç 2024-07-05
# ==============================================================
set -e

echo "üöÄ –ù–∞—á–∞–ª–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ FunPay Cortex (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)..."

# –®–ê–ì 0: –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
cd $HOME

# –®–ê–ì 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Python/Git..."
pkg update -y && pkg upgrade -y
pkg install -y python git

# –ò–Ω–æ–≥–¥–∞ pip –Ω–µ —Å—Ç–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
if ! command -v pip &> /dev/null; then
    echo "‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pip –≤—Ä—É—á–Ω—É—é..."
    python -m ensurepip --upgrade || pkg install -y python-pip
fi

# –®–ê–ì 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Å–±–æ—Ä–∫–∏ C-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
echo "üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Å–±–æ—Ä–∫–∏ (clang, libffi, openssl, rust, wheel)..."
pkg install -y clang libffi openssl rust

pip install --upgrade wheel setuptools

# –®–ê–ì 3: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
if [ ! -d "FunPayCortex" ]; then
    echo "üìÇ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è FunPayCortex..."
    git clone https://github.com/Beedgee/FunPayCortex.git
else
    echo "‚úÖ –ü–∞–ø–∫–∞ FunPayCortex —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ."
fi

cd FunPayCortex

# –®–ê–ì 4: –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –±–∏—Ç–æ–µ
if [ -d "venv" ]; then
    echo "‚ö†Ô∏è –°—Ç–∞—Ä–æ–µ venv –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –£–¥–∞–ª—è–µ–º –¥–ª—è —á–∏—Å—Ç–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏..."
    rm -rf venv
fi

# –®–ê–ì 5: –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "üêç –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è Python..."
python -m venv venv

# –ò–Ω–æ–≥–¥–∞ –≤ Termux –Ω—É–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫:
if [ -f "venv/bin/activate" ]; then
    source venv/bin/activate
else
    echo "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω —Ñ–∞–π–ª venv/bin/activate. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞."
    exit 1
fi

# –®–ê–ì 6: –ê–ø–≥—Ä–µ–π–¥ pip –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install --upgrade pip
pip install --upgrade wheel setuptools
pip install -r requirements.txt

echo ""
echo "üéâ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –≤–∫–ª—é—á–∞—è bcrypt."
echo ""
echo "üëâ –î–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã:"
echo "   1. cd ~/FunPayCortex"
echo "   2. source venv/bin/activate"
echo "   3. python main.py"
echo ""
